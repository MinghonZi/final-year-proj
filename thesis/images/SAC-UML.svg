<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="440px" preserveAspectRatio="none" style="width:1307px;height:440px;background:#FFFFFF;" version="1.1" viewBox="0 0 1307 440" width="1307px" zoomAndPan="magnify"><defs/><g><!--MD5=[b1b6beadaaeda70ff2c8857c26ba3f42]
class SAC--><g id="elem_SAC"><rect codeLine="2" fill="#F1F1F1" height="276.1563" id="SAC" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="370" x="477.5" y="157"/><ellipse cx="644.25" cy="173" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M647.2188,178.6406 Q646.6406,178.9375 646,179.0781 Q645.3594,179.2344 644.6563,179.2344 Q642.1563,179.2344 640.8281,177.5938 Q639.5156,175.9375 639.5156,172.8125 Q639.5156,169.6875 640.8281,168.0313 Q642.1563,166.375 644.6563,166.375 Q645.3594,166.375 646,166.5313 Q646.6563,166.6875 647.2188,166.9844 L647.2188,169.7031 Q646.5938,169.125 646,168.8594 Q645.4063,168.5781 644.7813,168.5781 Q643.4375,168.5781 642.75,169.6563 Q642.0625,170.7188 642.0625,172.8125 Q642.0625,174.9063 642.75,175.9844 Q643.4375,177.0469 644.7813,177.0469 Q645.4063,177.0469 646,176.7813 Q646.5938,176.5 647.2188,175.9219 L647.2188,178.6406 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="28" x="664.75" y="177.8467">SAC</text><line style="stroke:#181818;stroke-width:0.5;" x1="478.5" x2="846.5" y1="189" y2="189"/><polygon fill="none" points="488.5,197.6484,492.5,201.6484,488.5,205.6484,484.5,201.6484" style="stroke:#B38D22;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="121" x="497.5" y="205.9951">policy: nn.Module</text><polygon fill="none" points="488.5,213.9453,492.5,217.9453,488.5,221.9453,484.5,217.9453" style="stroke:#B38D22;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="172" x="497.5" y="222.292">qualities: List[nn.Module]</text><polygon fill="none" points="488.5,230.2422,492.5,234.2422,488.5,238.2422,484.5,234.2422" style="stroke:#B38D22;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="172" x="497.5" y="238.5889">log_temperature: Tensor</text><polygon fill="none" points="488.5,246.5391,492.5,250.5391,488.5,254.5391,484.5,250.5391" style="stroke:#B38D22;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="220" x="497.5" y="254.8857">target_qualities: List[nn.Module]</text><polygon fill="none" points="488.5,262.8359,492.5,266.8359,488.5,270.8359,484.5,266.8359" style="stroke:#B38D22;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="139" x="497.5" y="271.1826">target_entropy: float</text><polygon fill="none" points="488.5,279.1328,492.5,283.1328,488.5,287.1328,484.5,283.1328" style="stroke:#B38D22;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="185" x="497.5" y="287.4795">policy_optimiser: Optimizer</text><polygon fill="none" points="488.5,295.4297,492.5,299.4297,488.5,303.4297,484.5,299.4297" style="stroke:#B38D22;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="190" x="497.5" y="303.7764">quality_optimiser: Optimizer</text><polygon fill="none" points="488.5,311.7266,492.5,315.7266,488.5,319.7266,484.5,315.7266" style="stroke:#B38D22;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="232" x="497.5" y="320.0732">temperature_optimiser: Optimizer</text><polygon fill="none" points="488.5,328.0234,492.5,332.0234,488.5,336.0234,484.5,332.0234" style="stroke:#B38D22;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="257" x="497.5" y="336.3701">experience_replay: ExperienceReplay</text><polygon fill="none" points="488.5,344.3203,492.5,348.3203,488.5,352.3203,484.5,348.3203" style="stroke:#B38D22;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="100" x="497.5" y="352.667">batch_size: int</text><polygon fill="none" points="488.5,360.6172,492.5,364.6172,488.5,368.6172,484.5,364.6172" style="stroke:#B38D22;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="144" x="497.5" y="368.9639">discount_factor: float</text><polygon fill="none" points="488.5,376.9141,492.5,380.9141,488.5,384.9141,484.5,380.9141" style="stroke:#B38D22;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="128" x="497.5" y="385.2607">polyak_factor: float</text><line style="stroke:#181818;stroke-width:0.5;" x1="478.5" x2="846.5" y1="392.5625" y2="392.5625"/><ellipse cx="488.5" cy="406.2109" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="288" x="497.5" y="409.5576">compute_action(state: Tensor) -&gt; Tensor</text><ellipse cx="488.5" cy="422.5078" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="344" x="497.5" y="425.8545">step(state, action, reward, next_state, terminated)</text></g><!--MD5=[8b9206101721d2d1e60a6f50de559db9]
class TanhGaussianPolicy--><g id="elem_TanhGaussianPolicy"><rect codeLine="19" fill="#F1F1F1" height="56.2969" id="TanhGaussianPolicy" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="423" x="7" y="15.5"/><ellipse cx="145.25" cy="31.5" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M148.2188,37.1406 Q147.6406,37.4375 147,37.5781 Q146.3594,37.7344 145.6563,37.7344 Q143.1563,37.7344 141.8281,36.0938 Q140.5156,34.4375 140.5156,31.3125 Q140.5156,28.1875 141.8281,26.5313 Q143.1563,24.875 145.6563,24.875 Q146.3594,24.875 147,25.0313 Q147.6563,25.1875 148.2188,25.4844 L148.2188,28.2031 Q147.5938,27.625 147,27.3594 Q146.4063,27.0781 145.7813,27.0781 Q144.4375,27.0781 143.75,28.1563 Q143.0625,29.2188 143.0625,31.3125 Q143.0625,33.4063 143.75,34.4844 Q144.4375,35.5469 145.7813,35.5469 Q146.4063,35.5469 147,35.2813 Q147.5938,35 148.2188,34.4219 L148.2188,37.1406 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="138" x="165.75" y="36.3467">TanhGaussianPolicy</text><line style="stroke:#181818;stroke-width:0.5;" x1="8" x2="429" y1="47.5" y2="47.5"/><ellipse cx="18" cy="61.1484" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="397" x="27" y="64.4951">forward(self, state: Tensor) -&gt; Union[Distribution, Tensor]</text></g><!--MD5=[fab76ac332c6d72510aaae6c360fa182]
class Quality--><g id="elem_Quality"><rect codeLine="23" fill="#F1F1F1" height="56.2969" id="Quality" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="394" x="465.5" y="15.5"/><ellipse cx="635.25" cy="31.5" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M638.2188,37.1406 Q637.6406,37.4375 637,37.5781 Q636.3594,37.7344 635.6563,37.7344 Q633.1563,37.7344 631.8281,36.0938 Q630.5156,34.4375 630.5156,31.3125 Q630.5156,28.1875 631.8281,26.5313 Q633.1563,24.875 635.6563,24.875 Q636.3594,24.875 637,25.0313 Q637.6563,25.1875 638.2188,25.4844 L638.2188,28.2031 Q637.5938,27.625 637,27.3594 Q636.4063,27.0781 635.7813,27.0781 Q634.4375,27.0781 633.75,28.1563 Q633.0625,29.2188 633.0625,31.3125 Q633.0625,33.4063 633.75,34.4844 Q634.4375,35.5469 635.7813,35.5469 Q636.4063,35.5469 637,35.2813 Q637.5938,35 638.2188,34.4219 L638.2188,37.1406 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="46" x="655.75" y="36.3467">Quality</text><line style="stroke:#181818;stroke-width:0.5;" x1="466.5" x2="858.5" y1="47.5" y2="47.5"/><ellipse cx="476.5" cy="61.1484" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="368" x="485.5" y="64.4951">forward(self, state: Tensor, action: Tensor) -&gt; Tensor</text></g><!--MD5=[245f25cb4c70657a18033cbd8097abc6]
class UER--><g id="elem_UER"><rect codeLine="27" fill="#F1F1F1" height="72.5938" id="UER" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="406" x="894.5" y="7"/><ellipse cx="1078.75" cy="23" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M1081.7188,28.6406 Q1081.1406,28.9375 1080.5,29.0781 Q1079.8594,29.2344 1079.1563,29.2344 Q1076.6563,29.2344 1075.3281,27.5938 Q1074.0156,25.9375 1074.0156,22.8125 Q1074.0156,19.6875 1075.3281,18.0313 Q1076.6563,16.375 1079.1563,16.375 Q1079.8594,16.375 1080.5,16.5313 Q1081.1563,16.6875 1081.7188,16.9844 L1081.7188,19.7031 Q1081.0938,19.125 1080.5,18.8594 Q1079.9063,18.5781 1079.2813,18.5781 Q1077.9375,18.5781 1077.25,19.6563 Q1076.5625,20.7188 1076.5625,22.8125 Q1076.5625,24.9063 1077.25,25.9844 Q1077.9375,27.0469 1079.2813,27.0469 Q1079.9063,27.0469 1080.5,26.7813 Q1081.0938,26.5 1081.7188,25.9219 L1081.7188,28.6406 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="29" x="1099.25" y="27.8467">UER</text><line style="stroke:#181818;stroke-width:0.5;" x1="895.5" x2="1299.5" y1="39" y2="39"/><ellipse cx="905.5" cy="52.6484" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="380" x="914.5" y="55.9951">push(self, state, action, reward, next_state, terminated)</text><ellipse cx="905.5" cy="68.9453" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="262" x="914.5" y="72.292">sample(self, batch_size: int) -&gt; Batch:</text></g><!--MD5=[3d7d4e9ed660921cd3c72e814801ab37]
link TanhGaussianPolicy to SAC--><g id="link_TanhGaussianPolicy_SAC"><path codeLine="32" d="M267.29,71.91 C315.25,98.87 391.68,141.82 464.6,182.79 " fill="none" id="TanhGaussianPolicy-to-SAC" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="475.89,189.14,472.615,182.7155,465.4251,183.2675,468.7001,189.6921,475.89,189.14" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="36" x="363.5" y="123.0669">policy</text></g><!--MD5=[a3f53472b2ede584f468a0b39bbc29e9]
link Quality to SAC--><g id="link_Quality_SAC"><path codeLine="33" d="M662.5,71.68 C662.5,89.74 662.5,115.07 662.5,142.2 " fill="none" id="Quality-to-SAC" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="662.5,155,666.5,149,662.5,143,658.5,149,662.5,155" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="53" x="663.5" y="123.0669">qualities</text></g><!--MD5=[b237b8ce3298a683ec6c57f9243f007f]
link UER to SAC--><g id="link_UER_SAC"><path codeLine="34" d="M1035.18,80.25 C989.05,106.7 923.49,144.3 860.19,180.61 " fill="none" id="UER-to-SAC" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="849.3,186.86,856.4943,187.3522,859.7157,180.9007,852.5214,180.4084,849.3,186.86" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="116" x="981.5" y="123.0669">experience_replay</text></g><!--MD5=[aa56cba0c6621dee6cd2064c469bd126]
@startuml SAC

class SAC {
  # policy: nn.Module
  # qualities: List[nn.Module]
  # log_temperature: Tensor
  # target_qualities: List[nn.Module]
  # target_entropy: float
  # policy_optimiser: Optimizer
  # quality_optimiser: Optimizer
  # temperature_optimiser: Optimizer
  # experience_replay: ExperienceReplay
  # batch_size: int
  # discount_factor: float
  # polyak_factor: float
  + compute_action(state: Tensor) -> Tensor
  + step(state, action, reward, next_state, terminated)
}

class TanhGaussianPolicy {
  + forward(self, state: Tensor) -> Union[Distribution, Tensor]
}

class Quality {
  + forward(self, state: Tensor, action: Tensor) -> Tensor
}

class UER {
  + push(self, state, action, reward, next_state, terminated)
  + sample(self, batch_size: int) -> Batch:
}

TanhGaussianPolicy - -* SAC : policy
Quality - -* SAC : qualities
UER - -* SAC : experience_replay

hide empty fields
@enduml

PlantUML version 1.2022.7(Mon Aug 22 18:01:30 BST 2022)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: GB
--></g></svg>